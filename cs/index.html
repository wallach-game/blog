<!DOCTYPE html>
<html lang="cs">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="../style.css">
    <title>Dokument</title>
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-3197347955676346"
        crossorigin="anonymous"></script>
</head>

<body>
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-3197347955676346"
        crossorigin="anonymous"></script>
    <!-- Cookie Consent by FreePrivacyPolicy.com https://www.FreePrivacyPolicy.com -->
    <script type="text/javascript" src="//www.freeprivacypolicy.com/public/cookie-consent/4.2.0/cookie-consent.js"
        charset="UTF-8"></script>
    <script type="text/javascript" charset="UTF-8">
        document.addEventListener('DOMContentLoaded', function () {
            cookieconsent.run({ "notice_banner_type": "headline", "consent_type": "implied", "palette": "dark", "language": "cs", "page_load_consent_levels": ["strictly-necessary", "functionality", "tracking", "targeting"], "notice_banner_reject_button_hide": false, "preferences_center_close_button_hide": false, "page_refresh_confirmation_buttons": false });
        });
    </script>

    <noscript>Souhlas s cookies od <a href="https://www.freeprivacypolicy.com/">Free Privacy Policy
            Generator</a></noscript>
    <!-- End Cookie Consent by FreePrivacyPolicy.com https://www.FreePrivacyPolicy.com -->

    <a href="#" id="open_preferences_center">Aktualizovat nastaven√≠ cookies</a>

    <header class="">
        <h1>Numer√°tor≈Øv blog</h1>
    </header>

    <div class="wrapperMain">

        <div class="leftBanners">
            <div class="desktopWindow menu" style="width: 20vw; height: min-content; color: #D0CCD0;">
                <p style="margin: 0.25em">MENU</p>
                <p style="margin: 0.25em">JE</p>
                <p style="margin: 0.25em">ROZPRACOVAN√â</p>
            </div>
            <div class="desktopWindow ad-desktop">
                desktop
            </div>
            <div class="desktopWindow ad-mobile">
                mobiln√≠ reklama
            </div>
        </div>

        <div class="articles">
            <article class="desktopWindow details" data-before="test">
                <span>Numer√°tor 16. 1. 2025</span>
                <h3>
                    Kontejnery v Azure a intern√≠ s√≠≈•ov√° komunikace.
                </h3>
                <p><small><small>
                            TLDR: mƒõjte v≈°e v kontejnerech, nebo pou≈æijte Dapr nebo jin√Ω message broker. Intern√≠
                            komunikace z VM do kontejneru? Mo≈æn√° funguje. S ƒçasem se zlep≈°√≠ a d≈ô√≠ve to podle v≈°eho
                            fungovalo.
                        </small></small>
                    <br>
                    <br>
                    <small><small>Zkratky pou≈æit√©:<br>
                            ACA ‚û°Ô∏è Azure Container App<br>
                            ACI ‚û°Ô∏è Azure Container Instances
                        </small></small>
                </p>

                <p>
                    <big><big><big>K</big></big></big>dy≈æ mi zadali dockerizovat slu≈æbu, ≈ôekl jsem si: ‚ÄûSnadn√©. U≈æ jsem
                    to dƒõlal.‚Äú O p√°r t√Ωdn≈Ø pozdƒõji jsem mƒõl funkƒçn√≠ a otestovan√Ω kontejner po portaci star√© aplikace
                    .NET 4.3. ≈Ω√°dn√© exploze. Skvƒõl√Ω zaƒç√°tek.
                </p>
                <p>
                    T√Ωm se se≈°el, aby otestoval komunikaci kontejneru s VM p≈ôes internet. Nebylo to hladk√©, ale po
                    lehk√©m <em>‚Äûpopostrƒçen√≠‚Äú</em> (tj. debugov√°n√≠) zaƒçali komunikovat. Zapsali jsme si seznam √∫kol≈Ø,
                    dali si k√°vu, poslali nƒõco vla≈ænƒõ optimistick√©ho CTO a ≈°li dom≈Ø.
                </p>
                <p>
                    Pak p≈ôi≈°la realita: <strong>Jak p≈ôimƒõt VM, aby komunikovalo s kontejnerem p≈ôes intern√≠ s√≠≈•?</strong>
                </p>

                <h2>Priv√°tn√≠ komunikace: Peklo na zemi</h2>
                <p>
                    Slu≈æba byla nasazena jako Azure Container Apps (ACA). P≈ôepnut√≠ prost≈ôed√≠ ACA na priv√°tn√≠ s√≠≈•ov√°n√≠ mi
                    mi zobrazilo label <strong>(Preview).</strong> Co by se mohlo pokazit? Uk√°zalo se, ≈æe v≈°echno.
                </p>
                <p>
                    Povolen√≠ priv√°tn√≠ho s√≠≈•ov√°n√≠ automaticky vytvo≈ôilo novou skupinu zdroj≈Ø, ke kter√© jsem nemƒõl
                    p≈ô√≠stup. Rychl√° zpr√°va spr√°vci syst√©mu a mohl jsem pokraƒçovat.
                </p>
                <p>
                    Po p√°r √∫prav√°ch jsem vidƒõl slabou jiskru ≈æivota s <code>tcpping</code> na portu slu≈æby. Curl? Mrtv√Ω.
                    Zmƒõnil jsem porty. Teƒè u≈æ ani <code>tcpping</code> nefungoval. Vr√°til jsem je zpƒõt. U≈æ ani <code>tcpping</code> nefunguje.
                </p>
                <p>
                    V tu chv√≠li jsem si kladl existenci√°ln√≠ ot√°zky.
                </p>

                <h2>Googlen√≠ pro zachov√°n√≠ rozumu</h2>
                <p>
                    YouTube na z√°chranu? Ne. Jedinn√Ω tutori√°l, kter√Ω jsem na≈°el, byl dva roky star√Ω. Nakonec jsem narazil
                    na ofici√°ln√≠ Microsoft n√°vod, kter√Ω byl mƒõs√≠c star√Ω. Haleluja! A≈æ na to, ≈æe byl ne√∫pln√Ω, tak≈æe jsem
                    musel crossreferencovat CLI verzi, aby to zaƒçlo ‚Äûfungovalo‚Äú.
                </p>
                <p>
                    Nakonec se automaticky zaregistrovala intern√≠ URL kontejneru v priv√°tn√≠ DNS z√≥nƒõ. √öspƒõch? Ne. Slu≈æba st√°le
                    nefungovala. A kontejner zaƒçal padat, proto≈æe postupov√°n√≠ podle <em>ofici√°ln√≠ch</em> krok≈Ø
                    Microsoftu rozbilo komunikaci s Key Vaultem. Key Vault! Z√°klad cel√© slu≈æby. Skvƒõl√©.
                </p>

                <h2>"Statick√©" IP adresy a ACI</h2>
                <p>
                    Zoufal√Ω, vyzkou≈°el jsem Azure Container Instances (ACI). Ty maj√≠ velmi m√°lo funkc√≠, ≈æ√°dn√©
                    automatick√© aktualizace, ≈°k√°lov√°n√≠ dle po≈æadavk≈Ø atd. Tyto dost√°vaj√≠ IP ze subnetu. Perfektn√≠, ne?
                    NE. Statick√© IP? Zapome≈àte. IP se mƒõn√≠ p≈ôi ka≈æd√©m restartu kontejneru.
                </p>
                <p>
                    Nejlep≈°√≠ ƒç√°st? Pot≈ôebuji lok√°ln√≠ URL/IP kontejneru <em>p≈ôed</em> spu≈°tƒõn√≠m slu≈æby. A jedin√Ω zp≈Øsob,
                    jak ho z√≠skat? Spustit kontejner a pot√© se zeptat Azure CLI na jeho IP. Skvƒõl√©.
                </p>
                <p>
                    Tak jsem napsal rychl√Ω bash skript s <code>jq</code>, kter√Ω sebere IP a automaticky aktualizuje
                    konfiguraƒçn√≠ soubor. Bylo to chytr√©? Ano. P≈ôipadal jsem si, jako bych sv≈Øj projekt obalil lepic√≠ p√°skou?
                    Taky ano.
                </p>

                <h2>Z√°vƒõreƒçn√© my≈°lenky</h2>
                <p>
                    Jak tu sed√≠m s pivem v ruce a p≈ôem√Ω≈°l√≠m o posledn√≠ch dnech, zde je m≈Øj verdikt:
                </p>
                <p>
                    Ano, technicky je mo≈æn√© to zprovoznit. Ale up≈ô√≠mnƒõ? Nestoj√≠ to za to. U≈°et≈ôete si ƒças, rozum a
                    j√°tra. Buƒè p≈ôejdƒõte kompletnƒõ na kontejnery, nebo pou≈æijte Dapr. Cokoliv jin√©ho dopadne takto.
                </p>
                <p>
                    Na zdrav√≠ pro p≈ôe≈æit√≠ cloudu! üçª
                </p>
            </article>
        </div>
    </div>
</body>

</html>